<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ACSF Pro Hub 2025</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        body { background-color: #050505; color: #ececec; font-family: 'Inter', sans-serif; letter-spacing: -0.01em; }
        .nav-btn { font-size: 11px; font-weight: 900; color: #52525b; border-bottom: 2px solid transparent; padding-bottom: 8px; transition: 0.2s; }
        .nav-btn.active { color: #00ff85; border-color: #00ff85; }
        .card { background: #111113; border: 1px solid #222225; border-radius: 12px; overflow: hidden; }
        .badge { background: #00ff85; color: #050505; padding: 2px 6px; border-radius: 4px; font-weight: 900; font-size: 10px; }
        table { width: 100%; text-align: left; font-size: 12px; }
        th { padding: 12px; color: #71717a; text-transform: uppercase; font-size: 10px; font-weight: 900; }
        td { padding: 12px; border-top: 1px solid #1f1f22; }
        tr.clickable:hover { background: #18181b; cursor: pointer; }
        .modal { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.98); z-index: 100; padding: 20px; overflow-y: auto; }
        .search-results { position: absolute; top: 100%; left: 0; right: 0; background: #111113; border: 1px solid #222225; border-radius: 8px; z-index: 1000; max-height: 300px; overflow-y: auto; }
        
        /* Custom scrollbar for search */
        .search-results::-webkit-scrollbar { width: 4px; }
        .search-results::-webkit-scrollbar-thumb { background: #333; border-radius: 10px; }
    </style>
</head>
<body class="max-w-2xl mx-auto pb-20 border-x border-zinc-900 shadow-2xl">

    <header class="sticky top-0 bg-[#050505]/95 backdrop-blur-xl z-50 px-6 pt-8 border-b border-zinc-900">
        <div class="flex justify-between items-center mb-6">
            <h1 class="text-2xl font-black italic tracking-tighter text-[#00ff85]">ACSF</h1>
            <div class="relative w-48 md:w-64">
                <input type="text" id="mainSearch" placeholder="Search Player..." class="w-full bg-[#18181b] border border-zinc-800 rounded-lg px-4 py-2 text-xs outline-none focus:border-[#00ff85]" oninput="handleSearch()">
                <div id="searchResults" class="search-results hidden shadow-2xl"></div>
            </div>
        </div>
        <nav class="flex space-x-8">
            <button onclick="showTab('standings')" id="btn-standings" class="nav-btn active">STANDINGS</button>
            <button onclick="showTab('leaders')" id="btn-leaders" class="nav-btn">LEADERS</button>
        </nav>
    </header>

    <main class="px-4 mt-8">
        <div id="section-standings" class="space-y-10">
            <div>
                <h3 class="text-[10px] font-black text-zinc-500 mb-4 uppercase tracking-widest flex items-center gap-2">
                    <span class="w-2 h-2 bg-blue-500 rounded-full"></span> Eastern Conference
                </h3>
                <div class="card"><table id="table-eastern"></table></div>
            </div>
            <div>
                <h3 class="text-[10px] font-black text-zinc-500 mb-4 uppercase tracking-widest flex items-center gap-2">
                    <span class="w-2 h-2 bg-red-500 rounded-full"></span> Western Conference
                </h3>
                <div class="card"><table id="table-western"></table></div>
            </div>
        </div>

        <div id="section-leaders" class="hidden space-y-8">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div><h3 class="text-[9px] font-black text-zinc-500 mb-2 uppercase">Goals</h3><div id="list-goals" class="card divide-y divide-zinc-800"></div></div>
                <div><h3 class="text-[9px] font-black text-zinc-500 mb-2 uppercase">Assists</h3><div id="list-assists" class="card divide-y divide-zinc-800"></div></div>
                <div><h3 class="text-[9px] font-black text-zinc-500 mb-2 uppercase">Match Ratings</h3><div id="list-ratings" class="card divide-y divide-zinc-800"></div></div>
                <div><h3 class="text-[9px] font-black text-zinc-500 mb-2 uppercase">Clean Sheets</h3><div id="list-cleans" class="card divide-y divide-zinc-800"></div></div>
            </div>
        </div>
    </main>

    <div id="mainModal" class="modal">
        <div class="max-w-md mx-auto">
            <button onclick="closeModal()" class="mb-6 text-[#00ff85] text-xs font-black uppercase tracking-widest">‚Üê Close</button>
            <div id="modalContent"></div>
        </div>
    </div>

    <script>
        // REPLACE WITH YOUR LINKS
        const STANDINGS_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vS5yTQVQrEpc3LwF8vCZUu6rVk4vLFt97HjM5WYYQEy85b18G7XaV7m8FoNnd0VVg/pub?output=csv';
        const PLAYER_STATS_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vQGYlxWXa8fXFdQDf07aZrImlOsTiVcT36kgCbJKqlqDIWkhEEL7h642GOmJJx0uGBhqmeGz5OKmPqZ/pub?output=csv';

        // FIXED CONFERENCE LISTS
        const EASTERN_TEAMS = ["Inter Miami", "Columbus", "Atlanta", "NY City", "Cincinnati", "Philadelphia", "Charlotte", "Orlando", "Nashville", "New England", "Chicago", "NY Red Bulls", "Toronto", "Montreal", "DC United"];
        const WESTERN_TEAMS = ["Seattle", "San Diego FC", "Colorado", "Salt Lake", "Minnesota", "San Jose", "LA Galaxy", "Los Angeles", "Portland", "Vancouver", "Houston", "Austin", "Dallas", "Kansas City", "St. Louis"];

        let players = [], standings = [];

        async function init() {
            try {
                const fetchCsv = (url) => new Promise((resolve) => {
                    Papa.parse(url, { download: true, header: true, complete: (results) => resolve(results.data) });
                });

                standings = await fetchCsv(STANDINGS_URL);
                players = await fetchCsv(PLAYER_STATS_URL);
                render();
            } catch (e) { console.error("Data Load Error", e); }
        }

        function render() {
            // Render Standings
            const renderConference = (id, list) => {
                const data = standings
                    .filter(s => list.some(name => s.Team && s.Team.toLowerCase().includes(name.toLowerCase())))
                    .sort((a, b) => parseInt(b.PTS) - parseInt(a.PTS) || parseInt(b.GD) - parseInt(a.GD));
                
                document.getElementById(id).innerHTML = `
                    <thead><tr><th>#</th><th>Team</th><th>GD</th><th>PTS</th></tr></thead>
                    <tbody>${data.map((r, i) => `<tr class="clickable" onclick="openTeam('${r.Team}')">
                        <td class="text-zinc-600 font-bold">${i+1}</td>
                        <td class="font-bold">${r.Team}</td>
                        <td>${r.GD}</td><td class="font-black text-[#00ff85]">${r.PTS}</td>
                    </tr>`).join('')}</tbody>`;
            };
            renderConference('table-eastern', EASTERN_TEAMS);
            renderConference('table-western', WESTERN_TEAMS);

            // Render Leaders
            const drawLeaders = (id, key) => {
                const top = players
                    .filter(p => p[key] && !isNaN(parseFloat(p[key])) && parseFloat(p[key]) > 0)
                    .sort((a, b) => parseFloat(b[key]) - parseFloat(a[key]))
                    .slice(0, 5);

                document.getElementById(id).innerHTML = top.length ? top.map(p => `
                    <div class="p-3 flex justify-between items-center text-xs clickable" onclick="openPlayer('${p['Player Name']}')">
                        <div><div class="font-bold">${p['Player Name']}</div><div class="text-[9px] text-zinc-600 uppercase font-black">${p.Team}</div></div>
                        <span class="badge">${p[key]}</span>
                    </div>`).join('') : '<div class="p-4 text-zinc-600 text-[10px]">No Data Found</div>';
            };
            drawLeaders('list-goals', 'Goals');
            drawLeaders('list-assists', 'Assists');
            drawLeaders('list-ratings', 'MatchRatings');
            drawLeaders('list-cleans', 'CleanSheets');
        }

        function handleSearch() {
            const query = document.getElementById('mainSearch').value.toLowerCase();
            const resultsDiv = document.getElementById('searchResults');
            
            if (query.length < 2) { resultsDiv.classList.add('hidden'); return; }

            const pMatch = players.filter(p => p['Player Name'] && p['Player Name'].toLowerCase().includes(query)).slice(0, 6);
            const tMatch = standings.filter(s => s.Team && s.Team.toLowerCase().includes(query)).slice(0, 3);

            if (pMatch.length || tMatch.length) {
                resultsDiv.classList.remove('hidden');
                resultsDiv.innerHTML = `
                    ${tMatch.map(t => `<div onclick="openTeam('${t.Team}')" class="p-3 hover:bg-zinc-800 cursor-pointer text-[10px] font-black text-[#00ff85] uppercase border-b border-zinc-900">Team: ${t.Team}</div>`).join('')}
                    ${pMatch.map(p => `<div onclick="openPlayer('${p['Player Name']}')" class="p-3 hover:bg-zinc-800 cursor-pointer text-xs font-bold border-b border-zinc-900">${p['Player Name']} <span class="text-[9px] text-zinc-500 font-normal ml-1">(${p.Team})</span></div>`).join('')}
                `;
            } else { resultsDiv.classList.add('hidden'); }
        }

        function openPlayer(name) {
            const p = players.find(x => x['Player Name'] === name);
            if (!p) return;
            
            document.getElementById('mainModal').style.display = 'block';
            document.getElementById('searchResults').classList.add('hidden');
            
            const isGK = (p.CleanSheets && parseFloat(p.CleanSheets) > 0);

            document.getElementById('modalContent').innerHTML = `
                <div class="text-center mb-8">
                    <h2 class="text-4xl font-black italic text-white leading-tight">${p['Player Name']}</h2>
                    <p class="text-[#00ff85] font-black uppercase text-xs tracking-widest mt-2">${p.Team}</p>
                </div>
                <div class="grid grid-cols-2 gap-4">
                    <div class="card p-5 text-center"><div class="text-[9px] text-zinc-500 uppercase font-black mb-1">Match Rating</div><div class="text-3xl font-black text-[#00ff85]">${p.MatchRatings || '-'}</div></div>
                    <div class="card p-5 text-center"><div class="text-[9px] text-zinc-500 uppercase font-black mb-1">Played</div><div class="text-3xl font-black">${p.Played || p.MatchesPlayed || '-'}</div></div>
                    ${isGK ? 
                        `<div class="card p-5 text-center col-span-2"><div class="text-[9px] text-zinc-500 uppercase font-black mb-1">Clean Sheets</div><div class="text-3xl font-black text-blue-400">${p.CleanSheets}</div></div>` :
                        `<div class="card p-5 text-center"><div class="text-[9px] text-zinc-500 uppercase font-black mb-1">Goals</div><div class="text-3xl font-black">${p.Goals || 0}</div></div>
                         <div class="card p-5 text-center"><div class="text-[9px] text-zinc-500 uppercase font-black mb-1">Assists</div><div class="text-3xl font-black">${p.Assists || 0}</div></div>`
                    }
                </div>`;
        }

        function openTeam(teamName) {
            // Find players whose team includes the first word of the team name (to handle "Inter Miami CF" vs "Inter Miami")
            const searchKey = teamName.split(' ')[0];
            const roster = players.filter(p => p.Team && p.Team.includes(searchKey));
            
            document.getElementById('mainModal').style.display = 'block';
            document.getElementById('searchResults').classList.add('hidden');
            
            document.getElementById('modalContent').innerHTML = `
                <h1 class="text-4xl font-black italic text-[#00ff85] mb-6">${teamName}</h1>
                <div class="card">
                    <div class="p-3 grid grid-cols-4 text-[9px] font-black text-zinc-600 uppercase border-b border-zinc-800">
                        <div class="col-span-1">Player</div><div>G</div><div>A</div><div>RTG</div>
                    </div>
                    <div class="divide-y divide-zinc-800">
                        ${roster.sort((a,b) => parseFloat(b.MatchRatings) - parseFloat(a.MatchRatings)).map(p => `
                            <div onclick="openPlayer('${p['Player Name']}')" class="p-4 grid grid-cols-4 items-center text-xs hover:bg-zinc-800 cursor-pointer">
                                <div class="font-bold truncate">${p['Player Name']}</div>
                                <div>${p.Goals || 0}</div>
                                <div>${p.Assists || 0}</div>
                                <div class="text-[#00ff85] font-black">${p.MatchRatings || '-'}</div>
                            </div>
                        `).join('')}
                    </div>
                </div>`;
        }

        function showTab(tab) {
            document.getElementById('section-standings').classList.toggle('hidden', tab !== 'standings');
            document.getElementById('section-leaders').classList.toggle('hidden', tab !== 'leaders');
            document.getElementById('btn-standings').classList.toggle('active', tab === 'standings');
            document.getElementById('btn-leaders').classList.toggle('active', tab === 'leaders');
        }

        function closeModal() { document.getElementById('mainModal').style.display = 'none'; }
        
        // Initialize
        init();
    </script>
</body>
</html>
